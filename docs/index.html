<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>חיפוש טיולים - תכנן את המסע המושלם שלך</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #e74c3c;
            --accent-color: #f39c12;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background-color: var(--light-color);
        }
        .hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 5rem 0;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px);
            animation: move-background 20s linear infinite;
        }
        @keyframes move-background {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50%, 50%); }
        }
        .hero-content {
            position: relative;
            z-index: 1;
        }
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }
        .feature-icon {
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }
        .btn-custom {
            background-color: var(--accent-color);
            border: none;
            color: white;
            padding: 0.75rem 2rem;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        .btn-custom:hover {
            background-color: var(--secondary-color);
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .feature-card {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            height: 100%;
            transition: all 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        .section-bg {
            background-color: white;
            padding: 4rem 0;
            margin: 4rem 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 2rem 0;
        }
        .footer-icon {
            color: var(--light-color);
            font-size: 1.5rem;
            margin: 0 0.5rem;
            transition: color 0.3s ease;
        }
        .footer-icon:hover {
            color: var(--accent-color);
        }

        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            flex-direction: column;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
<header class="hero">
    <div class="container hero-content text-center">
        <h1 class="display-4 fw-bold mb-3">חיפוש טיולים</h1>
        <p class="lead mb-5">תכנן את המסע המושלם שלך בקלות ובמהירות</p>
        <a href="https://cheap-trips.runmydocker-app.com/" class="btn btn-custom btn-lg">התחל לחקור עכשיו</a>
    </div>
</header>

<main class="container my-5">
    <section class="row mb-5 section-bg">
        <div class="col-lg-8 mx-auto text-center">
            <h2 class="section-title">אודות הפרויקט שלי</h2>
            <p class="lead">חיפוש טיולים הוא הפתרון המקיף לתכנון הטיול שלך.<br>אנו משלבים מידע על טיסות, חדשות מקומיות ומקומות מרתקים לביקור, הכל מותאם אישית להעדפותיך.</p>
        </div>
    </section>

    <section class="row mb-5">
        <div class="col-lg-10 mx-auto">
            <h2 class="section-title text-center mb-5">איך זה עובד</h2>
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="feature-card">
                        <h3 class="h4 mb-3">1. התחברות</h3>
                        <p>הירשם או התחבר לחשבונך כדי להתחיל את החוויה המותאמת אישית.</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="feature-card">
                        <h3 class="h4 mb-3">2. הזנת פרטים</h3>
                        <p>ספק את פרטי הנסיעה שלך, כולל עיר מוצא, יעד, רדיוס חיפוש ומספר המקומות לביקור.</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="feature-card">
                        <h3 class="h4 mb-3">3. קבלת תוצאות</h3>
                        <p>קבל תוצאות מותאמות אישית בשלוש קטגוריות: טיסות, חדשות ומקומות לביקור.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="row mb-5 section-bg">
        <div class="col-lg-10 mx-auto">
            <h2 class="section-title text-center mb-5">תכונות מרכזיות</h2>
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="text-center">
                        <i class="fas fa-plane feature-icon"></i>
                        <h3 class="h4 mb-3">חיפוש טיסות</h3>
                        <p>מצא את הטיסות הזולות ביותר הזמינות בשעות הקרובות, כדי להבטיח שתקבל את העסקה הטובה ביותר לטיול שלך.</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="text-center">
                        <i class="fas fa-newspaper feature-icon"></i>
                        <h3 class="h4 mb-3">חדשות יעד</h3>
                        <p>הישאר מעודכן עם החדשות האחרונות מהיעד שלך. אנו מספקים דירוג של 1-5 כוכבים כדי לציין אם החדשות חיוביות או שליליות.</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="text-center">
                        <i class="fas fa-map-marker-alt feature-icon"></i>
                        <h3 class="h4 mb-3">מקומות לביקור</h3>
                        <p>גלה מיקומים מרגשים ליד היעד שלך. חפש מקומות ברדיוס של 10 עד 50 ק"מ ובחר כמה הצעות אתה רוצה.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="text-center mb-5">
        <h2 class="section-title">התחל עוד היום</h2>
        <p class="lead mb-4">מוכן לתכנן את ההרפתקה הבאה שלך? הירשם עכשיו והתחל לחקור!</p>
        <a href="https://cheap-trips.runmydocker-app.com/" class="btn btn-custom btn-lg">הירשם לחיפוש טיולים</a>
    </section>
</main>

<footer class="py-4 mt-5">
    <div class="container">
        <div class="row align-items-center" >
            <div class="col-md-6 text-center text-md-end" dir="ltr">
                <a href="https://www.linkedin.com/in/oren-golan/" class="footer-icon" aria-label="LinkedIn">
                    <i class="fab fa-linkedin-in"></i>
                </a>
                <a href="https://github.com/OrenGolanProjects" class="footer-icon" aria-label="GitHub">
                    <i class="fab fa-github"></i>
                </a>
                <a href="/swagger" class="footer-icon" aria-label="Swagger">
                    <i class="fas fa-book"></i>
                </a>
            </div>
            <div class="col-md-6 text-center text-md-start" dir="ltr">
                <p class="mb-0">&copy; 2024 CheapTrips by Oren Golan. All rights reserved</p>
            </div>
        </div>
    </div>
</footer>

<div id="loading-overlay" style="display: none;">
    <div class="spinner"></div>
    <p>אנא המתן, הדף נטען...</p>
    <button id="retry-button" class="btn btn-custom mt-3" style="display: none;">נסה שוב</button>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const mainAppUrl = 'https://cheap-trips.runmydocker-app.com/';
        const loadingOverlay = document.getElementById('loading-overlay');

        const retryButton = document.getElementById('retry-button');
        let retryCount = 0;
        const maxRetries = 3;

        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }

        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }

        function showRetryButton() {
            retryButton.style.display = 'block';
        }

        function hideRetryButton() {
            retryButton.style.display = 'none';
        }

        function openInNewTab(url) {
            window.open(url, '_blank');
        }

        function loadMainApp() {
            showLoading();
            hideRetryButton();

            let attempts = 0;
            const maxAttempts = 2;
            let intervalId = null;
            let newTab = null;

            function cleanup(forceClose = true) {
                if (intervalId) {
                    clearInterval(intervalId);
                }
                // Only close the tab if forceClose is true and it's not the final attempt
                if (forceClose && newTab && !newTab.closed && attempts < maxAttempts) {
                    newTab.close();
                }
            }

            function attemptLoad() {
                cleanup(attempts < maxAttempts); // Only force close if not final attempt

                attempts++;
                console.log(`Attempt ${attempts} of ${maxAttempts}`);

                // Open new tab
                newTab = window.open(mainAppUrl, '_blank');
                if (!newTab) {
                    console.log("Failed to open new tab - possibly blocked by popup blocker");
                    handleError();
                    return;
                }

                // Start checking the tab
                intervalId = setInterval(() => {
                    try {
                        // Check if tab was closed
                        if (newTab.closed) {
                            console.log("Tab was closed manually");
                            cleanup(false);
                            handleError();
                            return;
                        }

                        // Try to access tab content
                        if (newTab.document.title === "CheapTrips - חיפוש טיסות") {
                            console.log("Success: Tab title is correct");
                            cleanup(false);
                            hideLoading();
                            return;
                        }

                        console.log("Current tab title:", newTab.document.title);
                        console.log("Waiting for correct title...");

                    } catch (e) {
                        console.log("Cannot access tab content:", e.message);

                        // If this is a cross-origin error
                        if (e.message.includes("cross-origin")) {
                            if (attempts >= maxAttempts) {
                                console.log("Final attempt with cross-origin error - keeping tab open");
                                cleanup(false); // Don't close the tab
                                handleError();
                                return;
                            }
                        }
                        // Continue waiting if not final attempt
                    }
                }, 1000);

                // Set timeout for this attempt
                setTimeout(() => {
                    if (attempts < maxAttempts) {
                        console.log("Attempt timed out, trying again...");
                        attemptLoad();
                    } else {
                        console.log("All attempts exhausted - keeping tab open");
                        cleanup(false); // Don't close the tab on final attempt
                        handleError();
                    }
                }, 5000); // 10 second timeout per attempt
            }

            function handleError() {
                hideLoading();
                showRetryButton();
                // Don't reset attempts here anymore, as we want to track the final attempt
            }

            // Start the first attempt
            attemptLoad();

            // Add event listener for unload to cleanup
            window.addEventListener('unload', () => cleanup(false));
        }


        retryButton.addEventListener('click', function() {
            console.log("Retry button clicked");
            retryCount = 0;
            loadMainApp();
        });

        const appLinks = document.querySelectorAll('a[href="' + mainAppUrl + '"]');
        appLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                loadMainApp();
            });
        });
    });
</script>
</body>
</html>
